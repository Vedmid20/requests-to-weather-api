import requests
from requests.exceptions import HTTPError
from Mytoken import API_TOKEN

class Client:
    def __init__(self):
        self.url='http://api.openweathermap.org/geo/1.0/direct'
        self.quey={'q':'Lviv', 'limit':5, 'appid':API_TOKEN}

    def get_cord(self):
        try:
            response=requests.get(self.url, params=self.quey)
            response.raise_for_status()
            # print(response.json())
            lat=response.json()[0]['lat']
            lon=response.json()[0]['lon']
            return lat, lon
        except (HTTPError, ValueError) as err:
            print(f'Error {err}')

    def get_weather(self, lat, lon):
        try:
            url_get_weather='https://api.openweathermap.org/data/2.5/weather'
            query_get_weather={'lat':lat, 'lon':lon,'appid':API_TOKEN, 'units':'metric', 'lang':'ua' }
            response=requests.get(url_get_weather, params=query_get_weather)
            response.raise_for_status()
            print(response.json())
            #Температура (макс, мін), Швидкість вітру, Хмарність
            max_temp=response.json()['main']['temp_max']
            min_temp=response.json()['main']['temp_min']
            wind_sped=response.json()['wind']['speed']
            status=response.json()['weather'][0]['description']
            print(f'Макс темп {max_temp},Мін темп  {min_temp}, Швидкість {wind_sped}, Погода {status}')


        except (HTTPError, ValueError) as err:
            print(f'Error {err}')

if __name__ == '__main__':
    weather=Client()
    lat, lon=weather.get_cord()
    weather.get_weather(lat,lon)

